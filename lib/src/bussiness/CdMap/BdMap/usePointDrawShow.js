"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const v=require("vue"),y=require("../../../assets/images/icon_elevator.png.js");function E(s,i,e,g){const d=()=>{i.value&&i.value.clearOverlays()},r=t=>{e.cityName=t.label},l=v.ref({}),S=()=>{const t=`${e.cityName}${e.address}`;new BMap.Geocoder().getPoint(t,u=>{u?(l.value=u,i.value.centerAndZoom(l.value,s.zoom),f(),c()):(i.value.centerAndZoom(e.cityName,s.zoom),window.$Message.warning("您选择的地址没有解析到结果!"))},e.cityName)},p=()=>{e.editingState=!e.editingState,f(),c()},n=v.ref(),a=v.ref(),f=()=>{const t=o=>{l.value=o.point,i.value.removeOverlay(n.value),d(),c()};a.value&&(a.value.removeEventListener("dragging",t),i.value.removeOverlay(a.value)),a.value=new BMap.Marker(l.value,{enableDragging:e.editingState,enableMassClear:!1}),i.value.addOverlay(a.value),a.value.addEventListener("dragging",t)},c=()=>{const t=o=>{d(),e.circleRadius=o.target.xa};n.value&&(n.value.removeEventListener("lineupdate",t),i.value.removeOverlay(n.value)),n.value=new BMap.Circle(l.value,e.circleRadius,{strokeWeight:3,strokeOpacity:1,enableMassClear:!1,strokeStyle:e.editingState?"dashed":"solid",strokeColor:e.editingState?"#ff9900":"#57a3f3",fillColor:e.editingState?"#ff9900":"#fff",fillOpacity:e.editingState?.3:.5}),i.value.addOverlay(n.value),n.value[e.editingState?"enableEditing":"disableEditing"](),n.value.addEventListener("lineupdate",t)};return{onCityChange:r,onCitySearch:S,onUpdateEquipDraw:p,onEquipDrawSearch:async()=>{if(e.editingState)return window.$Message.warning("请先关闭绘制设备");if(e.equipList=await s.getDrawAreaEquips(l,e.circleRadius),e.equipList)for(let t of e.equipList){const o=new BMap.Icon(y.default,new BMap.Size(32,32),{imageSize:{width:20,height:25}}),u=new BMap.Point(t.gislong,t.gislat),q=new BMap.Marker(u,{icon:o});i.value.addOverlay(q)}},onEquipAdd:()=>{g&&g(e.equipList)}}}exports.default=E;
