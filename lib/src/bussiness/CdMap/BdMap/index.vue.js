"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),B=require("../../../basic/CdSelect/index.js"),g=require("../useMapLoad.js"),N=require("./usePointShow.js"),q=require("./usePointMultipleShow.js"),x=require("./usePointDrawShow.js"),I={class:"cd-map"},P={key:0,class:"cd-map-search"},D=e.defineComponent({name:"BdMap"}),E=e.defineComponent({...D,props:{initCity:{},detailAddress:{},zoom:{},mapHeight:{},isFirstShowWin:{type:Boolean},multipointMarker:{type:Boolean},multipointMarkerInfoShow:{type:Boolean},multipointMarkerList:{},isDrawMarker:{type:Boolean},cityParentCode:{},getDrawAreaEquips:{type:Function}},setup(d,{expose:p}){const t=d,u=(Date.now()+Math.random()).toString(),s=`BMap-${parseInt(u)}`,{loadBMap:m}=g.default();let o=e.ref();const C=async()=>{await m("iALbGbliO726jRgYKfYWum3a").catch(i=>Promise.reject(`地图加载失败:${i}`)),o.value=new BMap.Map(s),o.value.addControl(new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_RIGHT})),o.value.centerAndZoom(t.initCity,t.zoom),o.value.enableScrollWheelZoom(!0),setTimeout(()=>{t.multipointMarker?f():t.isDrawMarker?c():y()},500)};e.onMounted(()=>{C()});const{pointInit:y,usePoint:h}=N.default(t,o),f=q.default(t,o),n=e.reactive({cityCode:"650100",cityName:"乌鲁木齐市",address:"",editingState:!1,circleRadius:500,equipList:[]}),w=e.inject("drawEquipSelect"),{onCityChange:_,onCitySearch:c,onEquipAdd:M,onUpdateEquipDraw:k,onEquipDrawSearch:S}=x.default(t,o,n,w);return p({usePoint:h}),(i,a)=>{const v=e.resolveComponent("Icon"),V=e.resolveComponent("Input"),r=e.resolveComponent("Button");return e.openBlock(),e.createElementBlock("div",I,[t.isDrawMarker?(e.openBlock(),e.createElementBlock("div",P,[e.createVNode(V,{class:"cd-map-search-input",modelValue:n.address,"onUpdate:modelValue":a[1]||(a[1]=l=>n.address=l)},{prepend:e.withCtx(()=>[e.createVNode(e.unref(B.CdSelect),{class:"city-select",modelValue:n.cityCode,"onUpdate:modelValue":a[0]||(a[0]=l=>n.cityCode=l),type:"sys_area","p-val":t.cityParentCode,onOnChange:e.unref(_)},null,8,["modelValue","p-val","onOnChange"])]),append:e.withCtx(()=>[e.createVNode(v,{class:"city-search",type:"ios-search",size:"22",onClick:e.unref(c)},null,8,["onClick"])]),_:1},8,["modelValue"]),e.createVNode(r,{class:"ml10",type:"primary",onClick:e.unref(k)},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.editingState?"关闭":"开启")+"绘制设备 ",1)]),_:1},8,["onClick"]),e.createVNode(r,{class:"ml10",type:"primary",onClick:e.unref(S)},{default:e.withCtx(()=>[e.createTextVNode(" 搜索绘制设备 ")]),_:1},8,["onClick"]),e.createVNode(r,{class:"ml10",type:"primary",onClick:e.unref(M)},{default:e.withCtx(()=>[e.createTextVNode(" 添加绘制设备 ")]),_:1},8,["onClick"])])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"cd-map-box",id:s,style:e.normalizeStyle(`height: ${i.mapHeight};`)},null,4)])}}});exports.default=E;
