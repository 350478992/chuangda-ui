"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const config=require("@/config"),system=require("@/api/system"),baseTool=require("@/util/baseTool"),useTableSort=require("./useTableSort.js"),viewUiPlus=require("view-ui-plus");function useGetColumns($props,columns,tooltipParams){const{sortSet}=useTableSort.default(config,$props),pushCusColumnsHandle=t=>{t.value.push(...$props.customColumns)},reDefineColumns=resetColumns=>{var t;$props.customColumns.length&&pushCusColumnsHandle(resetColumns),$props.showIndex&&columns.value.push({title:"序号",width:$props.indexColWidth,align:"center",fixed:$props.isColFix?"left":"",render:(h,{row})=>{const tooltipShow=row.isBack==="1"&&$props.indexTooltip,showOkIconCondition="params.row."+$props.okIconGrammar,_toolTip=tooltipShow?h("div",{style:{display:"inline-block",padding:"2px 5px"},onMouseenter:o=>{tooltipParams.visible=!0,tooltipParams.reason=row[$props.reasonKey]||"",tooltipParams.style=`top:${o.clientY-o.offsetY}px;left:${o.clientX-o.offsetX+36}px;`},onMouseleave:()=>{tooltipParams.visible=!1}},[h(viewUiPlus.Icon,{type:"md-arrow-back"})]):"",_checkMark=baseTool.isNotEmpty($props.okIconGrammar)&&eval(showOkIconCondition)?h(viewUiPlus.Icon,{type:"md-checkmark"}):"";return h("div",[h("span",[_checkMark,row.ROWNUM_||row.index]),_toolTip])}}),$props.showCheckBox&&columns.value.push({type:"selection",width:55,align:"center",fixed:$props.isColFix?"left":""}),$props.tableAction&&$props.tableAction.title&&columns.value.push($props.tableAction);let colRenderMap={},colRenderLen=$props.colRenders.length;if(colRenderLen>0)for(let o=0;o<colRenderLen;o++){let e=$props.colRenders[o];colRenderMap[e.key]=e}for(let o=0;o<resetColumns.length;o++){let e=resetColumns[o];const s=colRenderMap[e.key||e.name];e.id&&s&&((t=s[e.key||e.name])!=null&&t.showType)&&(e.showType=s[e.name].showType),e.showType!=="hidden"&&(e.id&&(e.title=e.comments,e.key=e.name,e.width=e.compLength,e.fixed=$props.isColFix&&e.isFreeze==="1"?"left":"",s?e={...e,...s}:e.labelColor&&(e.render=function(n,{row:l}){return n("span",{style:{color:e.labelColor}},l[e.key])})),e.align="center",e.minWidth=e.minWidth||100,sortSet(e),columns.value.push(e))}},getLocalColumns=()=>{reDefineColumns($props.localColumns)},getRemoteColumns=t=>{system.api_getTableConfig(t).then(o=>{const{isSuccess:e,errorMsg:s,errmsg:n,data:l}=o||{};e?reDefineColumns(l.columns):window.$Message.error(s||n)})},getColumnsHandle=()=>{columns.value=[],$props.isLocalColumns?getLocalColumns():$props.tableViewNo?getRemoteColumns($props.tableViewNo):window.$Message.warning("表头视图不能为空")};return{getColumnsHandle}}exports.default=useGetColumns;
