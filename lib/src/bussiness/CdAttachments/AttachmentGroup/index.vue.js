"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),h=require("@/api/system"),c=require("../../../basic/CdButton/index.js"),w=require("../Attachment/index.vue.js"),g=require("../AttachmentUpload/index.vue.js"),_=e.defineComponent({name:"CdAttachmentGroup"}),V=e.defineComponent({..._,props:{modelValue:{type:Boolean},lookOnly:{type:Boolean},groupAtttype:{},groupApiType:{},attrefsysid:{},url:{},uploadShow:{type:Boolean,default:!1},delShow:{type:Boolean,default:!0},itemcode:{},isOss:{type:Boolean}},emits:["update:modelValue"],setup(m,{emit:y}){const l=m,u=e.computed({get:()=>l.modelValue,set:s=>{y("update:modelValue",s)}}),f=e.computed(()=>[{title:"序号",type:"index",align:"center",width:80},{title:"操作",align:"center",width:160,render:(s,{row:a})=>{const i=[s(c.CdButton,{size:"small",style:{marginRight:"10px"},onclick:()=>v(a)},"上传"),s(c.CdButton,{size:"small",onclick:()=>S(a)},`查看${a.attSum}`)];return l.lookOnly&&i.splice(0,1),s("div",i)}},{title:"材料名称",key:"attname",align:"center"}]);let d=e.ref([]);const p=()=>{h.getGroupAttList({id:l.attrefsysid,attGroupType:l.groupAtttype},l.groupApiType).then(s=>{const{isSuccess:a,errorMsg:i,errmsg:r,data:n}=s.data||{};a?d.value=n:window.$Message.error(i||r)})};e.onBeforeMount(()=>{p()});const o=e.reactive({visible:!1}),v=s=>{o.visible=!0,o.itemcode=l.itemcode,o.isOss=l.isOss,o.attrefsysid=l.attrefsysid,o.atttype=s.atttype,o.fileTitleShow=!1},t=e.reactive({visible:!1}),S=s=>{t.visible=!0,t.atttype=s.atttype,t.showSearchPanel=!1,t.url=l.url,t.attrefsysid=l.attrefsysid,t.uploadShow=l.lookOnly?!1:l.uploadShow,t.delShow=l.lookOnly?!1:l.delShow,t.cusColumns=[{comments:"材料名称",name:"attname",align:"center"},{comments:"上传时间",name:"createDate",align:"center"}]};return e.provide("onUploadSuccessHandle",s=>{p()}),(s,a)=>{const i=e.resolveComponent("Table"),r=e.resolveComponent("CdModal");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(r,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=n=>u.value=n),title:"附件分组列表","footer-hide":!0,onOnCancel:a[1]||(a[1]=n=>u.value=!1)},{default:e.withCtx(()=>[e.createVNode(i,{data:e.unref(d),columns:f.value,border:""},null,8,["data","columns"])]),_:1},8,["modelValue"]),o.visible?(e.openBlock(),e.createBlock(g.default,{key:0,modelValue:o.visible,"onUpdate:modelValue":a[2]||(a[2]=n=>o.visible=n),itemcode:o.itemcode,attrefsysid:o.attrefsysid,atttype:o.atttype,fileTitleShow:o.fileTitleShow,isOss:o.isOss},null,8,["modelValue","itemcode","attrefsysid","atttype","fileTitleShow","isOss"])):e.createCommentVNode("",!0),t.visible?(e.openBlock(),e.createBlock(w.default,{key:1,modelValue:t.visible,"onUpdate:modelValue":a[3]||(a[3]=n=>t.visible=n),url:t.url,attrefsysid:t.attrefsysid,atttype:t.atttype,showSearchPanel:t.showSearchPanel,uploadShow:t.uploadShow,delShow:t.delShow,cusColumns:t.cusColumns},null,8,["modelValue","url","attrefsysid","atttype","showSearchPanel","uploadShow","delShow","cusColumns"])):e.createCommentVNode("",!0)])}}});exports.default=V;
