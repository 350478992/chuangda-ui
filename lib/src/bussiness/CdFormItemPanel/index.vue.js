"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue");require("./style/index.css");const u=require("@/config"),F=require("@/api/system/layoutApi"),v=require("../CdFormField/index.js"),E=require("@/use/useLocalStorage"),_=require("@/util"),q={class:"form-box"},z={class:"group-box"},L={class:"font-700"},O=e.defineComponent({name:"CdFormItemPanel"}),T=e.defineComponent({...O,props:{size:{type:String,default:u.defaultFormSize||"default"},noShowFieldControl:{type:Array,default:()=>[]},readOnly:{type:Boolean,default:!1},showRequired:{type:Boolean,default:!1},lazy:{type:Boolean,default:!1},name:{type:String,required:!0},viewNo:{type:String,required:!0},attrPrefix:{type:String,default:""},formObject:{type:Object,required:!0},ruleValidate:{type:Object,default:()=>({})},slots:{type:Array,default:()=>[]},fullItemKeys:{type:Array,default:()=>[]},defaultClosePanels:{type:Array,default:()=>[]}},emits:["renderPercentPath"],setup(a,{emit:R}){const i=a,p=e.ref(u.showSubformPanelProp),g=e.ref(1),k=e.ref(!1),h=e.ref([]),d=e.ref({id:"",no:"",name:"",type:"",formcol:1,dictColumns:[],groups:[],columns:[]}),B=async()=>{let{value:t,setValue:r}=E.useLocalStorage(i.viewNo,"");if(!(u.viewConfigCache&&t)){const l=await F.getFormConfig(i.viewNo);_.handleResponse(l,()=>{t=l.data,t&&r(t)},!1)}t.formcol&&(t.formcol=parseInt(t.formcol)),d.value=t,y(t.columns),V(t.groups),console.info("ðŸš€ ~ file:index method: line:223 -----",t)},y=(t=[])=>{t.length>0&&t.forEach(r=>S(r))},V=(t=[])=>{t.length>0&&t.forEach((r,l)=>{var s;y((r==null?void 0:r.columns)??[]),(s=i.defaultClosePanels)!=null&&s.includes(l)||h.value.push(`${l}`)}),d.value.groups=t},S=t=>{const{compLength:r,dictType:l,dictParentId:s,dictParentValue:m}=t;t.viewId=d.value.id,t.compLength=r?`${r}px`:"100%",t.dictConf={type:l||"",parentId:s||"",parentValue:m||""},t.colWidth=t.isLine==="1"?24:24/d.value.formcol},w=t=>{if(i.showRequired)return{required:t.isNull==="1",message:"è¯·å¡«å†™"+t.comments,trigger:"blur"}},b=t=>{var r;return t.colWidth===24?t.showType==="textarea"?"width:98%;":(r=i.fullItemKeys)!=null&&r.includes(t.name)?"width:100%;":`width:${1/d.value.formcol*100}%;`:"width: 100%;"};return e.onMounted(()=>{console.info("ðŸš€ ~ file:index method: line:313 -----",i.slots),i.viewNo&&d.value.columns.length===0&&B()}),(t,r)=>{const l=e.resolveComponent("Progress"),s=e.resolveComponent("Form-item"),m=e.resolveComponent("Col"),C=e.resolveComponent("Row"),x=e.resolveComponent("Panel"),N=e.resolveComponent("Collapse");return e.openBlock(),e.createElementBlock("div",q,[e.withDirectives(e.createVNode(l,{percent:g.value,"hide-info":""},null,8,["percent"]),[[e.vShow,k.value]]),e.createVNode(C,null,{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value.columns,o=>e.withDirectives((e.openBlock(),e.createBlock(m,{span:o.colWidth,key:o.id},{default:e.withCtx(()=>[e.createVNode(s,{rules:w(o),style:e.normalizeStyle(o.colWidth==24&&o.showType=="textarea"?"width:98%;":""),label:o.comments,"label-width":200,prop:o.name},{default:e.withCtx(()=>[e.createElementVNode("span",{slot:"label",class:e.normalizeClass(o.styleName)},e.toDisplayString(o.comments),3),o.showType!=="hidden"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(p.value?`${o.name},${o.dbName}`:""),1)],64)):e.createCommentVNode("",!0),e.createVNode(e.unref(v.CdFormField),{modelValue:a.formObject[a.attrPrefix+o.name],"onUpdate:modelValue":c=>a.formObject[a.attrPrefix+o.name]=c,type:o.showType,size:a.size,name:o.name,prop:o.name,disabled:o.isReadonly==="1",readonly:o.isReadonly==="1"||a.readOnly,width:o.compLength,dictConf:o.dictConf},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.slots,(c,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[o.name==c?(e.openBlock(),e.createElementBlock("div",{key:n},[e.renderSlot(t.$slots,c)])):e.createCommentVNode("",!0)],64))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","type","size","name","prop","disabled","readonly","width","dictConf"])]),_:2},1032,["rules","style","label","prop"])]),_:2},1032,["span"])),[[e.vShow,o.showType!=="hidden"]])),128))]),_:3}),e.createElementVNode("div",z,[e.createVNode(N,{"model-value":h.value},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value.groups,(o,c)=>(e.openBlock(),e.createBlock(x,{name:`${c}`,key:o.id},{content:e.withCtx(()=>[e.createVNode(C,null,{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.columns,n=>e.withDirectives((e.openBlock(),e.createBlock(m,{span:n.colWidth,key:n.id},{default:e.withCtx(()=>[a.noShowFieldControl.indexOf(n.name)==-1?(e.openBlock(),e.createBlock(s,{key:0,rules:w(n),style:e.normalizeStyle(b(n)),"label-width":200,prop:n.name},{label:e.withCtx(()=>[e.createElementVNode("div",{class:e.normalizeClass(n.styleName)},e.toDisplayString(n.comments),3)]),default:e.withCtx(()=>[n.showType!=="hidden"?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(p.value?n.name:""),1)],64)):e.createCommentVNode("",!0),e.createVNode(e.unref(v.CdFormField),{modelValue:a.formObject[n.name],"onUpdate:modelValue":f=>a.formObject[n.name]=f,type:n.showType,size:a.size,name:n.name,prop:n.name,readonly:n.isReadonly==="1"||a.readOnly,disabled:n.isReadonly==="1",width:n.compLength,dictConf:n.dictConf},e.createSlots({_:2},[e.renderList(i.slots,(f,P)=>({name:f,fn:e.withCtx(()=>[n.name==f?(e.openBlock(),e.createElementBlock("div",{key:P},[e.renderSlot(t.$slots,f)])):e.createCommentVNode("",!0)])}))]),1032,["modelValue","onUpdate:modelValue","type","size","name","prop","readonly","disabled","width","dictConf"])]),_:2},1032,["rules","style","prop"])):e.createCommentVNode("",!0)]),_:2},1032,["span"])),[[e.vShow,n.showType!=="hidden"]])),128))]),_:2},1024)]),default:e.withCtx(()=>[e.createElementVNode("span",L,e.toDisplayString(o.name),1)]),_:2},1032,["name"]))),128))]),_:3},8,["model-value"])])])}}});exports.default=T;
