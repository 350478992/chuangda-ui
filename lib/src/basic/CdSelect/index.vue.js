"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue");require("./style/index.css");const B=require("view-ui-plus"),C=require("@/api/system"),S=e.defineComponent({name:"CdSelect"}),b=e.defineComponent({...S,props:{modelValue:{type:[String,Array],default:""},list:{type:Array,default:()=>[]},equclacode:{type:String,default:""},type:{type:String,default:""},pId:{type:String,default:"-1"},pVal:{type:String,default:""},size:{type:String,default:"default"},empty:{type:Boolean,default:!0},labelInValue:{type:Boolean,default:!0},selectFirst:{type:Boolean,default:!1}},emits:["update:modelValue","on-change","on-query"],setup(r,{emit:d}){const l=r;let n=e.ref([]),c=e.ref(!1),v=e.ref(l.empty);e.watch(()=>l.pVal,t=>p()),e.watch(()=>l.empty,t=>v.value=t),e.watch(()=>l.list,t=>{t.length>0?p():n.value=[]},{deep:!0});const u=e.computed({get(){return l.modelValue},set(t){d("update:modelValue",t)}}),m=e.computed(()=>!!l.equclacode);e.onMounted(()=>{p()});const y=t=>{d("on-change",t||{})},g=t=>{d("on-query",t||{})},p=()=>{var t,o;((t=l.list)==null?void 0:t.length)>0?(n.value=l.list,l.selectFirst&&!u.value&&(u.value=n.value[0].value)):((o=l.list)==null?void 0:o.length)===0&&l.type&&V()},V=async()=>{const{type:t,pId:o,pVal:s}=l;c.value=!0;const i=await C.apiFindDictList({type:t,parentId:o,parentValue:s}),{isSuccess:a,errorMsg:f,errormsg:k,data:h}=i;a?(n.value=h||[],l.selectFirst&&n.value.length>0&&!u.value&&(u.value=n.value[0].value)):B.Message.error(`数据字典错误：${f||k}`),c.value=!1};return(t,o)=>{const s=e.resolveComponent("Select"),i=e.resolveComponent("Option");return e.openBlock(),e.createElementBlock("div",null,[e.unref(c)?(e.openBlock(),e.createBlock(s,{key:0})):e.createCommentVNode("",!0),e.unref(c)?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(s,e.mergeProps({key:1,modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=a=>u.value=a),size:r.size,"label-in-value":r.labelInValue,transfer:!0,clearable:""},t.$attrs,{onOnChange:y,onOnQueryChange:g}),{default:e.withCtx(()=>[e.unref(v)?(e.openBlock(),e.createBlock(i,{key:0,value:""},{default:e.withCtx(()=>[e.createTextVNode("请选择")]),_:1})):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(a,f)=>(e.openBlock(),e.createBlock(i,{disabled:m.value&&a.value!=r.equclacode,value:a.value,label:a.label,key:`${a.value}${f}`},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.label),1)]),_:2},1032,["disabled","value","label"]))),128))]),_:1},16,["modelValue","size","label-in-value"]))])}}});exports.default=b;
