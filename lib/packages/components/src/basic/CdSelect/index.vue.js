"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue");require("./style/index.css");const B=require("view-ui-plus"),S=require("@/api/system"),b=e.defineComponent({name:"cdSelect"}),C=e.defineComponent({...b,props:{modelValue:{type:[String,Array],default:""},list:{default:()=>[]},equclacode:{type:String,default:""},type:{type:String,default:""},pId:{type:String,default:"-1"},pVal:{type:String,default:""},size:{type:String,default:"default"},empty:{type:Boolean,default:!0},labelInValue:{type:Boolean,default:!0},selectFirst:{type:Boolean,default:!1}},emits:["update:modelValue","on-change","on-query"],setup(u,{emit:d}){const l=u;let n=e.ref([]),r=e.ref(!1),v=e.ref(l.empty);e.watch(()=>l.pVal,t=>p()),e.watch(()=>l.empty,t=>v.value=t),e.watch(()=>l.list,t=>{t.length>0?p():n.value=[]},{deep:!0});const o=e.computed({get(){return l.modelValue},set(t){d("update:modelValue",t)}}),m=e.computed(()=>!!l.equclacode);e.onMounted(()=>{p()});const y=t=>{d("on-change",t||{})},g=t=>{d("on-query",t||{})},p=()=>{l.list.length>0?(n.value=l.list,l.selectFirst&&!o.value&&(o.value=n.value[0].value)):l.list.length===0&&l.type&&V()},V=async()=>{const{type:t,pId:c,pVal:s}=l;r.value=!0;const i=await S.apiFindDictList({type:t,parentId:c,parentValue:s}),{isSuccess:a,errorMsg:f,errormsg:k,data:h}=i;a?(n.value=h||[],l.selectFirst&&n.value.length>0&&!o.value&&(o.value=n.value[0].value)):B.Message.error(`数据字典错误：${f||k}`),r.value=!1};return(t,c)=>{const s=e.resolveComponent("Select"),i=e.resolveComponent("Option");return e.openBlock(),e.createElementBlock("div",null,[e.unref(r)?(e.openBlock(),e.createBlock(s,{key:0})):e.createCommentVNode("",!0),e.unref(r)?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(s,e.mergeProps({key:1,modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=a=>o.value=a),size:u.size,"label-in-value":u.labelInValue,transfer:!0,clearable:""},t.$attrs,{onOnChange:y,onOnQueryChange:g}),{default:e.withCtx(()=>[e.unref(v)?(e.openBlock(),e.createBlock(i,{key:0,value:""},{default:e.withCtx(()=>[e.createTextVNode("请选择")]),_:1})):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(a,f)=>(e.openBlock(),e.createBlock(i,{disabled:m.value&&a.value!=u.equclacode,value:a.value,label:a.label,key:`${a.value}${f}`},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.label),1)]),_:2},1032,["disabled","value","label"]))),128))]),_:1},16,["modelValue","size","label-in-value"]))])}}});exports.default=C;
